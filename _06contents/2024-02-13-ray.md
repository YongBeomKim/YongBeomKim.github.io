---
layout: blog
title: (도서) ⚝⚝⚝⚝ 러닝 레이
tags:
- book
---

이 책을 보기 전까지는 [Ray](https://pypi.org/project/ray/#history) 모듈을 접하지 못했었습니다. 때문에 이 책 표지에 **대규모 모델 훈련에 빠르게 분산처리** 라는 소제목을 접했을 때 `Asyncio` 같은 비동기 모듈인지, `Dask` 같은 연산처리 모듈 중 어디에 해당하는지 여부가 궁금 했었습니다.

<br/>

# Start Ray
`Ray Project` 는 위처럼 딥러닝 모듈과 연동되는 등 대규모 오픈소스 입니다. 때문에 처음 예제들을 실행할 때 어려움이 있었습니다. 가장 큰 이유는 책은 `22년 11월` 릴리즈 된 `Ray 2.2.0` 을 기준으로 메서드 들이 정의되어 있는데 반해 최근 `2024년 2월 6일` 기준으로 `2.9.2`로 업데이트 되어 있습니다. 

Python 3.11 환경에서 설치를 진행하면 아래와 같은 오류를 출력합니다.
```bash
$ pip install "ray[rllib, serve, tune]==2.2.0"

ERROR: Could not find a version that satisfies the requirement ray==2.2.0 
(from versions: 2.3.0, 2.3.1, 2.4.0, 2.5.0, 2.5.1, 2.6.0, 2.6.1, 2.6.2, 
2.6.3, 2.7.0rc0, 2.7.0, 2.7.1, 2.7.2, 2.8.0, 2.8.1, 2.9.0, 2.9.1, 2.9.2)
ERROR: No matching distribution found for ray==2.2.0
```

책의 내용을 실습하기 위해선 `Python 3.10` 환경에서 진행해야 되고, [Python 3.11 은 ray 2.6.1](https://github.com/ray-project/ray/releases/tag/ray-2.6.1) 이후 버젼부터 지원합니다. 따라서 책을 실습하는 초보자 분들이라면 꼭 `Python 3.10` 에서 필요한 모듈들을 설치하여 실습을 진행하시기 바랍니다.





```python
[In] :  import ray
        ray.init()

[Out] : 2024-02-18 15:10:33,346	INFO worker.py:1715 
-- Started a local Ray instance. 
View the dashboard at 127.0.0.1:8265 

Python version: 	3.10.11
Ray version: 	2.9.2
Dashboard: 	http://127.0.0.1:8265
```

때문에 몇몇 예제들은 아래의 예시와 같이 오류를 출력 했습니다. 때문에 최신버젼을 활용하기 위해선 변경된 모듈 API 내용으로 수정 작업을 해 줘야 합니다. 책에서 실행했던 `2.2` 버젼은 `2022년 12월` 내용으로 대략 1년전 모듈인데, `2.5` 에서 중요한 업데이트가 진행된 것으로 보입니다.

```python
[In] : squares = ds.map(lambda x: x["data"] ** 2)
       evens   = squares.filter(lambda x: x % 2 == 0)
       cubes   = evens.flat_map(lambda x: [x, x**3])
       sample = cubes.take(10)
       print(sample)

[Out] : ValueError: Error validating 160000: 
Standalone Python objects are not allowed in Ray 2.5. 
To return Python objects from map(), wrap them in a dict, 
e.g., return `{'item': item}` instead of just `item`.
```

이러한 점은 단점아닌 장점이 될 수 있는데 `Ray` 오픈소스 컨트리뷰터 분들이 활발하게 활동한다는 의미기도 해서, 처음 접하신 분들은 책에서 안내하는 버젼으로 내용을 익힌 뒤 [Ray 공식문서](https://docs.ray.io/en/latest/data/api/doc/ray.data.Dataset.map.html) 를 참고하여 수정보완을 하면 됩니다.

```bash
! pip install "ray[rllib, tune, serve]==2.2.0"
```

<br/>

# 총평

```bash
sudo apt-get install libsodium-dev


pip install "ray[rllib, serve, tune]==2.3.0"
pip install "pyarrow==14.0.0"
pip install "tensorflow>=2.9.0"
pip install "transformers>=4.24.0"
pip install "pygame==2.5.2" "gym==0.25.0"

```

※ 본 리뷰는 IT 현업개발자가, 한빛미디어 책을 제공받아 작성한 서평입니다.

<figure class="align-center">
  <p style="text-align: center">
  <img width="510px" src="{{site.baseurl}}/assets/book/learnray.jpg">
  <figcaption>러닝 레이</figcaption>
  </p>
</figure>
